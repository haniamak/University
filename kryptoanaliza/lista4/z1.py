n_hex = "B72D43FEF3AEEA60A94B766A02022D1461EA5FEBD486DF26084E5B8677A092E4BB4F50BC37C6DD78ACE707B9DD4E190627922756F5885BCF1C493C21C051B34D198832EDDC6C412DF479E3E4CFFC9D781437C79276912C2083BF7026DAA0B510BD9698382A6C345BAFA23C2F91C519CB5FA0D0530DEF9FE4D26C489D8D004AABA37D9D7EECA40036D3F70B0A9FF9CBEFA6A4F903ECB4E2D887341EF5C5485140411093C02E9EFE625E37D8F87BFDEE4DD81D30ECCB9113A104C5E1E40ADB8E44EA2ABAC4A9F002D160658C8282A8EB38AC60A5BF3B2A607DFAB606AC400FD9B82D842361EB30126641F95B26D2FC2FC29575E903D389754710698DDDE60A9C1B"
e_hex = "010001"
d_hex = "813A3AFD33B753FC8B930460373887CB1864FBF4E943994C4091DF3A174D3E3485FCA7CD916007C0E9E2376E25B5C22BB86100C5F5849498A1B0FCEE26BABCCF08D33072E48DAED217E6A2233BA4510774E40134CFD70D15873CD88760B7FDE5688B44AA632B6128C9D89FB3439894E1087EF05997BC54C65EB92BE592A30109B1944978562EB6D1A95E24F2147E44A63C355AC853CB486B7A96EF1BC38E7A8B4E55EE663FB403BC38780FA44AE2334E53B034642B612618B2FCA3C6A2B40FBC0791DA88001D4F1393710EBF57329C8CCD5CE6EE3B1BE33E1CAFD4AB670E73E3E5B6CB7C295485F702ACFE969C29C69C56F6F0215F4B59539382DBFFBFE55DC9"
p_hex = "E7DC5B322003BC064BA2BF7528260BC040DAA9B9097506AD3FCE3EDE928D7CFAB4BCB71A5267BE821A8C648C1DE579FC61A445C85FD4055E8BECA770832A08A043196819DC11E6B02AED4EC5673BE291CCA40D9F6F342434D09339430D8F5CD940659DEE2568829D397D29DC98EA3B508E71B1D250B33743A3010900EF91708F"
q_hex = "CA3F5DA34E01D966F9E48EE964FA3E201990CC351B9597BA76C0C6DDB45BECF64838D66DCDC3520382E4F75D3E487B0C56FB1A37164D48DA30655BB89F6D2921B26CAFF007622FD06C13B1EAFC87B4E309EB2E2B33DC98F959A1CE79048EA836432FDE0DF038CBB9A30DD70D1DFAA9891FD2046B03EA55133B0D9273F32F09B5"
dp_hex = "A63CAB7608D6249D2EE584F7EECD3867A31823CFF323E0A19EB9B501C779823E0E0FB0084344F6A6397AA72C7ED2E4DF3AF298C5CD4F2A7A5B4055DCA96E1DB929E2B16CB9086CA9AA5D72B8BE0785AE9B56941DD7913ED44F26FF4B4011A5B46E236D542DA5FCDFD534142B81C78EB77729B520E1935CF03592AC6DEB560FA9"
dq_hex = "0B82C3BF91A7054A991A6B0FD9916C8BC328BC96A1354867726ED262B7EB2B7770F0DB3370AC97345FF4CC27606E1BA2BE28987B5E2793E7E72D3DA52A5DBA2392D620C556863E166CB04A46078D69BC2A4A5A5C571D4D0F940C6385FBBE6AD07BCE73A2F37328152EB490F2CC2C020E2DE37420EB1E212D7104FABAE2B260A9"
qinv_hex = "53681A7E9BCA10E865F484D97FDA37320ACCDABCCBA59C6F4B750AEE0FAD4205F0A20CF9FA7CBD0EE6A93121A52C73A8D9322B398D9DA299DF6D6324566F95C6E8D5D8C3C24FF68C41CB19B6BBB0E8AE3992755A966755A0225B64EB913A2941FF1F914FD2A40FD99B85EF2F37DB8C42F1754EC75C429CF6A662B516F7910D83"

n = int(n_hex, 16)
e = int(e_hex, 16)
d = int(d_hex, 16)
p = int(p_hex, 16)
q = int(q_hex, 16)
dp = int(dp_hex, 16)
dq = int(dq_hex, 16)
qinv = int(qinv_hex, 16)

print("CHECK: ")

print("TEST 1: czy n = pq:")
pq = p * q
if pq == n: print("p * q = n")
else: print("p * q != n")

from math import gcd
phi = (p - 1) * (q - 1)
dcheck_phi = pow(e, -1, phi)
print("Czy d = e^(-1) mod phi(n)?", d == dcheck_phi)

lcm = (p - 1) * (q - 1) // gcd(p - 1, q - 1)
d_check = pow(e, -1, lcm)
print("TEST 2: czy d = e^(-1) mod lcm(p-1, q-1):")
if d_check == d: print("d = e^(-1) mod lcm(p-1, q-1)")
else: print("d != e^(-1) mod lcm(p-1, q-1)")
print(d_check, "\n")
print(d)


dpcheck = pow(e, -1, p - 1)

print("TEST 3: czy dp = e^(-1) mod (p-1):")
if dpcheck == dp: print("dp = e^(-1) mod (p-1)")
else: print("dp != e^(-1) mod (p-1)")

dqcheck = pow(e, -1, q - 1)

print("TEST 4: czy dq = e^(-1) mod (q-1):")
if dqcheck == dq: print("dq = e^(-1) mod (q-1)")
else: print("dq != e^(-1) mod (q-1)")

qinvcheck = pow(q, -1, p)

print("TEST 5: czy qinv = q^(-1) mod p:")
if qinvcheck == qinv: print("qinv = q^(-1) mod p")
else: print("qinv != q^(-1) mod p")


c_hex = """59dc3b0327e09b6b762385ac3fa1724a5c3761338018c1c69d691d563be751377119397a86bd0873
b9dd4259b94cdc7398fecbe9c252a4ef682bb09c17afad343e4c38f264b12abfff5aef54f830a08b
8c30e334bbd94a003310b5678a238135b1b89c324246129a6d8fcc34aa18386444ae3bf1d4bb7adb
603da50b44683e024e32dcee966531d1204d34a4cd51cf53431acb3044588a4de8ca124154308f55
7796873763fd625767b4296266e2c7ce07f891b8c6716deb78de0b84c6883fc42633a6ceee2b4118
e3c105c55de092a61fbca5cc4ec1f9a29c45a688d18d49ae5296363668e30c611e4ecbaacdfc4af9
458110a80ecab25a6e2b19745271c1be"""

c = int(c_hex.replace("\n", ""), 16)

m = pow(c, d, n)
plaintext = m.to_bytes(n.bit_length()+7//8, 'big')
print(plaintext.decode('utf-8'))

# Adi Shamir and Leonard Adleman comes from their 1978 paper, 
# "A Method for Obtaining Digital Signatures and Public-Key Cryptosystems",
# published in the Communications of the ACM